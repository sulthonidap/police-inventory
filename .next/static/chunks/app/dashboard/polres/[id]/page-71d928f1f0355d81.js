(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9560],{2868:(e,s,t)=>{Promise.resolve().then(t.bind(t,4531))},2023:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(8030).Z)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},1240:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(8030).Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},4531:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var a=t(7437),l=t(2265),r=t(6463),c=t(8185),i=t(9733),n=t(9055),d=t(1266),x=t(4499),o=t(7524),m=t(4241),h=t(1240),j=t(2023),g=t(6763);function p(){let e=(0,r.useParams)(),s=(0,r.useRouter)(),{toast:t}=(0,g.pm)(),[p,u]=(0,l.useState)(null),[N,y]=(0,l.useState)([]),[b,v]=(0,l.useState)([]),[f,w]=(0,l.useState)([]),[k,Z]=(0,l.useState)(!0);(0,l.useEffect)(()=>{e.id&&(A(),E())},[e.id]);let A=async()=>{try{console.log("Fetching polres detail for ID:",e.id);let s=await fetch("/api/polres/".concat(e.id));if(console.log("Response status:",s.status),s.ok){let e=await s.json();console.log("Polres data:",e),u(e)}else{let e=await s.json();console.error("API Error:",e),t({title:"Error",description:e.error||"Gagal memuat data Polres",variant:"destructive"})}}catch(e){console.error("Error fetching polres:",e),t({title:"Error",description:"Terjadi kesalahan saat memuat data",variant:"destructive"})}},E=async()=>{try{console.log("Fetching related data for polres ID:",e.id);let s=await fetch("/api/users?polresId=".concat(e.id,"&limit=5"));if(console.log("Users response status:",s.status),s.ok){let e=await s.json();console.log("Users data:",e),y(e.users||[])}else console.error("Failed to fetch users:",await s.text());let t=await fetch("/api/assets?polresId=".concat(e.id,"&limit=5"));if(console.log("Assets response status:",t.status),t.ok){let e=await t.json();console.log("Assets data:",e),v(e.assets||[])}else console.error("Failed to fetch assets:",await t.text());let a=await fetch("/api/reports?polresId=".concat(e.id,"&limit=5"));if(console.log("Reports response status:",a.status),a.ok){let e=await a.json();console.log("Reports data:",e),w(e.reports||[])}else console.error("Failed to fetch reports:",await a.text())}catch(e){console.error("Error fetching related data:",e)}finally{Z(!1)}},C=()=>{s.push("/dashboard/polres")},I=e=>new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"}),T=e=>({ADMIN:"bg-purple-100 text-purple-800",KORLANTAS:"bg-blue-100 text-blue-800",POLDA:"bg-indigo-100 text-indigo-800",POLRES:"bg-cyan-100 text-cyan-800",USER:"bg-gray-100 text-gray-800"})[e]||"bg-gray-100 text-gray-800",M=e=>({ACTIVE:"bg-green-100 text-green-800",INACTIVE:"bg-red-100 text-red-800",PENDING:"bg-yellow-100 text-yellow-800"})[e]||"bg-gray-100 text-gray-800",P=e=>({ACTIVE:"bg-green-100 text-green-800",MAINTENANCE:"bg-yellow-100 text-yellow-800",RETIRED:"bg-red-100 text-red-800",LOST:"bg-gray-100 text-gray-800"})[e]||"bg-gray-100 text-gray-800",D=(e,s)=>"CUSTOM"===e&&s?(0,a.jsx)(n.C,{variant:"outline",className:"text-xs",children:s}):(0,a.jsx)(n.C,{className:"text-xs ".concat({UMUM:"bg-blue-100 text-blue-800",INTERNAL:"bg-purple-100 text-purple-800",CUSTOM:"bg-orange-100 text-orange-800"}[e]||"bg-gray-100 text-gray-800"),children:e});return k?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):p?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)(i.z,{variant:"outline",onClick:C,className:"flex items-center space-x-2",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Kembali"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:p.name}),(0,a.jsx)("p",{className:"text-gray-600",children:"Detail Polres dan Data Terkait"})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)(n.C,{variant:"outline",className:"text-sm",children:p.polda.name})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Informasi Polres"})]})}),(0,a.jsxs)(c.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Nama Polres"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:p.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Polda"}),(0,a.jsx)("p",{className:"text-sm",children:p.polda.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Alamat"}),(0,a.jsx)("p",{className:"text-sm",children:p.address})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Telepon"}),(0,a.jsx)("p",{className:"text-sm",children:p.phone})]})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(o.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Statistik"})]})}),(0,a.jsx)(c.aY,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:p._count.users}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Users"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:p._count.assets}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Assets"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:p._count.reports}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Reports"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-orange-600",children:[Math.round(p._count.assets/Math.max(p._count.users,1)*100),"%"]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Asset/User"})]})]})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Timeline"})]})}),(0,a.jsxs)(c.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Dibuat"}),(0,a.jsx)("p",{className:"text-sm",children:I(p.createdAt)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Terakhir Update"}),(0,a.jsx)("p",{className:"text-sm",children:I(p.updatedAt)})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5"}),(0,a.jsxs)("span",{children:["Users (",N.length,")"]})]})}),(0,a.jsx)(c.aY,{children:0===N.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(h.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Belum ada users"})]}):(0,a.jsx)("div",{className:"space-y-3",children:N.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.email}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:["NRP: ",e.nrp]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end space-y-1",children:[(0,a.jsx)(n.C,{className:"text-xs ".concat(T(e.role)),children:e.role}),(0,a.jsx)(n.C,{className:"text-xs ".concat(M(e.status)),children:e.status})]})]},e.id))})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(o.Z,{className:"w-5 h-5"}),(0,a.jsxs)("span",{children:["Assets (",b.length,")"]})]})}),(0,a.jsx)(c.aY,{children:0===b.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(o.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Belum ada assets"})]}):(0,a.jsx)("div",{className:"space-y-3",children:b.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.category}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:["No: ",e.inventoryNumber]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end space-y-1",children:[(0,a.jsx)(n.C,{className:"text-xs ".concat(P(e.status)),children:e.status}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.year})]})]},e.id))})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.Z,{className:"w-5 h-5"}),(0,a.jsxs)("span",{children:["Reports (",f.length,")"]})]})}),(0,a.jsx)(c.aY,{children:0===f.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(j.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Belum ada reports"})]}):(0,a.jsx)("div",{className:"space-y-3",children:f.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:e.title}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["by ",e.user.name]}),(0,a.jsx)("div",{className:"text-xs text-gray-400",children:I(e.createdAt)})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end space-y-1",children:[D(e.type,e.customType),(0,a.jsx)(n.C,{className:"text-xs ".concat(M(e.status)),children:e.status})]})]},e.id))})})]})]})]}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Polres Tidak Ditemukan"}),(0,a.jsx)(i.z,{onClick:C,children:"Kembali ke Daftar Polres"})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[8502,7696,7130,6215,1744],()=>s(2868)),_N_E=e.O()}]);