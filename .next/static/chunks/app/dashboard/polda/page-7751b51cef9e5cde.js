(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2234],{3478:(e,a,s)=>{Promise.resolve().then(s.bind(s,9412))},5733:(e,a,s)=>{"use strict";s.d(a,{Z:()=>l});let l=(0,s(8030).Z)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},3274:(e,a,s)=>{"use strict";s.d(a,{Z:()=>l});let l=(0,s(8030).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2513:(e,a,s)=>{"use strict";s.d(a,{Z:()=>l});let l=(0,s(8030).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},6649:(e,a,s)=>{"use strict";s.d(a,{Z:()=>l});let l=(0,s(8030).Z)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},6463:(e,a,s)=>{"use strict";var l=s(1169);s.o(l,"useParams")&&s.d(a,{useParams:function(){return l.useParams}}),s.o(l,"usePathname")&&s.d(a,{usePathname:function(){return l.usePathname}}),s.o(l,"useRouter")&&s.d(a,{useRouter:function(){return l.useRouter}}),s.o(l,"useSearchParams")&&s.d(a,{useSearchParams:function(){return l.useSearchParams}})},9412:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>f});var l=s(7437),t=s(2265),r=s(6463),n=s(8185),i=s(9733),d=s(9055),c=s(7304),o=s(4662),h=s(7209),m=s(402),p=s(2513),x=s(3274),u=s(4817),j=s(5733),g=s(6649),v=s(883),N=s(6763),y=s(7149);function f(){let e=(0,r.useRouter)(),[a,s]=(0,t.useState)([]),[f,b]=(0,t.useState)(!0),[P,k]=(0,t.useState)(!1),[w,C]=(0,t.useState)(!1),[S,M]=(0,t.useState)(!1),[_,E]=(0,t.useState)(!1),[D,Z]=(0,t.useState)(null),[z,T]=(0,t.useState)({isOpen:!1,type:null,poldaId:null,poldaName:null}),[I,O]=(0,t.useState)({page:1,limit:10,total:0,totalPages:0,hasNext:!1,hasPrev:!1}),[A,F]=(0,t.useState)(10),[R,q]=(0,t.useState)(""),[B,G]=(0,t.useState)({name:"",address:"",phone:""}),{toast:H}=(0,N.pm)();(0,t.useEffect)(()=>{K()},[I.page,A,R]);let K=async()=>{try{let e=new URLSearchParams({page:I.page.toString(),limit:A.toString(),...R&&{search:R}}),a=await fetch("/api/polda?".concat(e)),l=await a.json();l.poldas?(s(l.poldas),O(l.pagination)):(s(l),O({page:1,limit:A,total:l.length,totalPages:Math.ceil(l.length/A),hasNext:!1,hasPrev:!1}))}catch(e){console.error("Error fetching poldas:",e),H({variant:"destructive",title:"Error",description:"Gagal memuat data Polda"})}finally{b(!1)}},L=async e=>{e.preventDefault(),C(!0);try{let e=await fetch("/api/polda",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)});if(e.ok)k(!1),G({name:"",address:"",phone:""}),K(),H({variant:"success",title:"Berhasil!",description:"Polda baru berhasil ditambahkan"});else{let a=await e.json();H({variant:"destructive",title:"Error",description:a.message||"Gagal menambahkan Polda"})}}catch(e){console.error("Error creating polda:",e),H({variant:"destructive",title:"Error",description:"Terjadi kesalahan saat menambah Polda"})}finally{C(!1)}},V=(e,a,s)=>{T({isOpen:!0,type:e,poldaId:a,poldaName:s})},$=()=>{T({isOpen:!1,type:null,poldaId:null,poldaName:null})},J=async()=>{z.poldaId&&z.type&&("delete"===z.type&&await U(z.poldaId),$())},U=async e=>{try{console.log("Deleting polda:",e);let a=await fetch("/api/polda/".concat(e),{method:"DELETE"});if(console.log("Response status:",a.status),a.ok)K(),H({variant:"success",title:"Berhasil!",description:"Polda berhasil dihapus"});else{let e=await a.json();console.error("Delete failed:",e),H({variant:"destructive",title:"Error",description:e.error||"Gagal menghapus Polda"})}}catch(e){console.error("Error deleting polda:",e),H({variant:"destructive",title:"Error",description:"Gagal menghapus Polda"})}},Y=e=>{O(a=>({...a,page:e}))},W=e=>{q(e),O(e=>({...e,page:1}))},Q=a=>{e.push("/dashboard/polda/".concat(a))},X=async(e,a)=>{try{let a=await fetch("/api/polda/".concat(e));if(a.ok){let e=await a.json();Z(e),G({name:e.name,address:e.address||"",phone:e.phone||""}),M(!0)}else H({variant:"destructive",title:"Error",description:"Gagal memuat data Polda"})}catch(e){console.error("Error fetching polda for edit:",e),H({variant:"destructive",title:"Error",description:"Gagal memuat data Polda"})}},ee=async e=>{if(e.preventDefault(),D){C(!0);try{let e=await fetch("/api/polda/".concat(D.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)});if(e.ok)M(!1),G({name:"",address:"",phone:""}),Z(null),K(),H({variant:"success",title:"Berhasil!",description:"Polda berhasil diperbarui"});else{let a=await e.json();H({variant:"destructive",title:"Error",description:a.message||"Gagal memperbarui Polda"})}}catch(e){console.error("Error updating polda:",e),H({variant:"destructive",title:"Error",description:"Terjadi kesalahan saat memperbarui Polda"})}finally{C(!1)}}};return f?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsx)("div",{className:"text-lg",children:"Memuat data Polda..."})}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold",children:"Manajemen Polda"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"Kelola data Kepolisian Daerah"})]}),(0,l.jsxs)(o.Vq,{open:P,onOpenChange:k,children:[(0,l.jsx)(o.hg,{asChild:!0,children:(0,l.jsxs)(i.z,{children:[(0,l.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Tambah Polda"]})}),(0,l.jsxs)(o.cZ,{className:"sm:max-w-[425px]",children:[(0,l.jsx)(o.fK,{children:(0,l.jsx)(o.$N,{children:"Tambah Polda Baru"})}),(0,l.jsxs)("form",{onSubmit:L,className:"space-y-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{htmlFor:"name",children:"Nama Polda"}),(0,l.jsx)(h.I,{id:"name",value:B.name,onChange:e=>G({...B,name:e.target.value}),placeholder:"Masukkan nama Polda",required:!0})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{htmlFor:"address",children:"Alamat"}),(0,l.jsx)(h.I,{id:"address",value:B.address,onChange:e=>G({...B,address:e.target.value}),placeholder:"Masukkan alamat Polda"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{htmlFor:"phone",children:"Nomor Telepon"}),(0,l.jsx)(h.I,{id:"phone",value:B.phone,onChange:e=>G({...B,phone:e.target.value}),placeholder:"Masukkan nomor telepon"})]}),(0,l.jsxs)(o.cN,{children:[(0,l.jsx)(i.z,{type:"button",variant:"outline",onClick:()=>k(!1),children:"Batal"}),(0,l.jsx)(i.z,{type:"submit",disabled:w,children:w?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Menyimpan..."]}):"Simpan"})]})]})]})]})]}),(0,l.jsx)(n.Zb,{children:(0,l.jsx)(n.aY,{children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-2",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{htmlFor:"search",children:"Cari"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(u.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,l.jsx)(h.I,{id:"search",placeholder:"Cari nama, alamat, atau nomor telepon...",value:R,onChange:e=>W(e.target.value),className:"pl-10"})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{children:"Total Data"}),(0,l.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:I.total})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{htmlFor:"pageSize",children:"Data per Halaman"}),(0,l.jsxs)("select",{id:"pageSize",value:A,onChange:e=>{F(parseInt(e.target.value)),O(e=>({...e,page:1}))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:5,children:"5 data"}),(0,l.jsx)("option",{value:10,children:"10 data"}),(0,l.jsx)("option",{value:20,children:"20 data"}),(0,l.jsx)("option",{value:50,children:"50 data"})]})]})]})})}),(0,l.jsx)(n.Zb,{children:(0,l.jsxs)(n.aY,{children:[(0,l.jsxs)(c.iA,{children:[(0,l.jsx)(c.xD,{children:(0,l.jsxs)(c.SC,{children:[(0,l.jsx)(c.ss,{children:"Nama Polda"}),(0,l.jsx)(c.ss,{children:"Jumlah Polres"}),(0,l.jsx)(c.ss,{children:"Alamat"}),(0,l.jsx)(c.ss,{children:"Nomor Telepon"}),(0,l.jsx)(c.ss,{className:"w-[150px]",children:"Aksi"})]})}),(0,l.jsx)(c.RM,{children:0===a.length?(0,l.jsx)(c.SC,{children:(0,l.jsx)(c.pj,{colSpan:5,className:"text-center py-8 text-gray-500",children:"Tidak ada data Polda"})}):a.map(e=>(0,l.jsxs)(c.SC,{children:[(0,l.jsx)(c.pj,{className:"font-medium",children:e.name}),(0,l.jsx)(c.pj,{children:(0,l.jsxs)(d.C,{variant:"secondary",children:[e._count.polres," Polres"]})}),(0,l.jsx)(c.pj,{children:e.address?e.address.length>30?"".concat(e.address.substring(0,30),"..."):e.address:(0,l.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,l.jsx)(c.pj,{children:e.phone||(0,l.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,l.jsx)(c.pj,{children:(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsxs)(i.z,{size:"sm",variant:"outline",className:"h-7 px-2 text-xs bg-blue-600 border-blue-200 text-white hover:bg-blue-100 transition-all duration-200 hover:scale-105",onClick:()=>Q(e.id),children:[(0,l.jsx)(j.Z,{className:"mr-1 h-3 w-3"}),"Detail"]}),(0,l.jsxs)(i.z,{size:"sm",variant:"outline",className:"h-7 px-2 text-xs bg-green-600 border-green-200 text-white hover:bg-green-100 transition-all duration-200 hover:scale-105",onClick:()=>X(e.id,e.name),children:[(0,l.jsx)(g.Z,{className:"mr-1 h-3 w-3"}),"Edit"]}),(0,l.jsxs)(i.z,{size:"sm",variant:"outline",className:"h-7 px-2 text-xs bg-red-600 border-red-200 text-white hover:bg-red-100 transition-all duration-200 hover:scale-105",onClick:()=>V("delete",e.id,e.name),children:[(0,l.jsx)(v.Z,{className:"mr-1 h-3 w-3"}),"Hapus"]})]})})]},e.id))})]}),I.totalPages>1&&(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsx)(y.tl,{children:(0,l.jsxs)(y.ng,{children:[(0,l.jsx)(y.nt,{children:(0,l.jsx)(y.dN,{onClick:()=>Y(I.page-1),className:I.hasPrev?"cursor-pointer":"pointer-events-none opacity-50"})}),(()=>{let e=[],a=I.totalPages,s=I.page;if(e.push(1),a<=7)for(let s=2;s<=a;s++)e.push(s);else{s>3&&e.push("...");let l=Math.max(2,s-1),t=Math.min(a-1,s+1);for(let a=l;a<=t;a++)e.includes(a)||e.push(a);s<a-2&&e.push("..."),a>1&&e.push(a)}return e.map((e,a)=>(0,l.jsx)(y.nt,{children:"..."===e?(0,l.jsx)("span",{className:"px-3 py-2 text-gray-500",children:"..."}):(0,l.jsx)(y.kN,{onClick:()=>Y(e),isActive:e===s,className:"cursor-pointer",children:e})},a))})(),(0,l.jsx)(y.nt,{children:(0,l.jsx)(y.$0,{onClick:()=>Y(I.page+1),className:I.hasNext?"cursor-pointer":"pointer-events-none opacity-50"})})]})}),(0,l.jsxs)("div",{className:"text-center mt-4 text-sm text-gray-500",children:["Menampilkan ",(I.page-1)*A+1," - ",Math.min(I.page*A,I.total)," dari ",I.total," data"]})]})]})}),(0,l.jsx)(o.Vq,{open:z.isOpen,onOpenChange:$,children:(0,l.jsxs)(o.cZ,{className:"sm:max-w-[425px]",children:[(0,l.jsx)(o.fK,{children:(0,l.jsx)(o.$N,{children:"Hapus Polda"})}),(0,l.jsxs)("div",{className:"py-4",children:[(0,l.jsxs)("p",{className:"text-gray-600",children:['Apakah Anda yakin ingin menghapus Polda "',z.poldaName,'"?']}),(0,l.jsx)("p",{className:"text-sm text-red-600 mt-2",children:"Tindakan ini tidak dapat dibatalkan dan akan menghapus semua data terkait."})]}),(0,l.jsxs)(o.cN,{children:[(0,l.jsx)(i.z,{variant:"outline",onClick:$,children:"Batal"}),(0,l.jsx)(i.z,{onClick:J,variant:"destructive",children:"Hapus"})]})]})}),(0,l.jsx)(o.Vq,{open:_,onOpenChange:E,children:(0,l.jsxs)(o.cZ,{className:"sm:max-w-[600px]",children:[(0,l.jsx)(o.fK,{children:(0,l.jsx)(o.$N,{children:"Detail Polda"})}),D&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{className:"font-semibold",children:"Nama Polda"}),(0,l.jsx)("p",{className:"text-gray-700",children:D.name})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{className:"font-semibold",children:"Jumlah Polres"}),(0,l.jsxs)(d.C,{variant:"secondary",children:[D._count.polres," Polres"]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{className:"font-semibold",children:"Alamat"}),(0,l.jsx)("p",{className:"text-gray-700",children:D.address||"-"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{className:"font-semibold",children:"Nomor Telepon"}),(0,l.jsx)("p",{className:"text-gray-700",children:D.phone||"-"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{className:"font-semibold",children:"Tanggal Dibuat"}),(0,l.jsx)("p",{className:"text-gray-700",children:new Date(D.createdAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{className:"font-semibold",children:"Terakhir Update"}),(0,l.jsx)("p",{className:"text-gray-700",children:new Date(D.updatedAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{className:"font-semibold",children:"ID Polda"}),(0,l.jsx)("p",{className:"text-gray-700 text-sm font-mono",children:D.id})]})]}),(0,l.jsx)(o.cN,{children:(0,l.jsx)(i.z,{variant:"outline",onClick:()=>E(!1),children:"Tutup"})})]})}),(0,l.jsx)(o.Vq,{open:S,onOpenChange:M,children:(0,l.jsxs)(o.cZ,{className:"sm:max-w-[425px]",children:[(0,l.jsx)(o.fK,{children:(0,l.jsx)(o.$N,{children:"Edit Polda"})}),(0,l.jsxs)("form",{onSubmit:ee,className:"space-y-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{htmlFor:"edit-name",children:"Nama Polda"}),(0,l.jsx)(h.I,{id:"edit-name",value:B.name,onChange:e=>G({...B,name:e.target.value}),placeholder:"Masukkan nama Polda",required:!0})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{htmlFor:"edit-address",children:"Alamat"}),(0,l.jsx)(h.I,{id:"edit-address",value:B.address,onChange:e=>G({...B,address:e.target.value}),placeholder:"Masukkan alamat Polda"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m._,{htmlFor:"edit-phone",children:"Nomor Telepon"}),(0,l.jsx)(h.I,{id:"edit-phone",value:B.phone,onChange:e=>G({...B,phone:e.target.value}),placeholder:"Masukkan nomor telepon"})]}),(0,l.jsxs)(o.cN,{children:[(0,l.jsx)(i.z,{type:"button",variant:"outline",onClick:()=>M(!1),children:"Batal"}),(0,l.jsx)(i.z,{type:"submit",disabled:w,children:w?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Menyimpan..."]}):"Simpan Perubahan"})]})]})]})})]})}},8364:(e,a,s)=>{"use strict";s.d(a,{f:()=>i});var l=s(2265),t=s(5171),r=s(7437),n=l.forwardRef((e,a)=>(0,r.jsx)(t.WV.label,{...e,ref:a,onMouseDown:a=>{var s;a.target.closest("button, input, select, textarea")||(null===(s=e.onMouseDown)||void 0===s||s.call(e,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));n.displayName="Label";var i=n}},e=>{var a=a=>e(e.s=a);e.O(0,[8502,6252,1114,8778,5410,7130,6215,1744],()=>a(3478)),_N_E=e.O()}]);