(()=>{var e={};e.id=3002,e.ids=[3002],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},79348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},84770:e=>{"use strict";e.exports=require("crypto")},92222:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>j,routeModule:()=>h,serverHooks:()=>f,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>w});var s={};t.r(s),t.d(s,{POST:()=>g,dynamic:()=>l,maxDuration:()=>m,preferredRegion:()=>c,runtime:()=>p});var a=t(52412),i=t(14293),n=t(94147),o=t(77856),u=t(47726),d=t(82009);let p="nodejs",l="force-dynamic",c="auto",m=30;async function g(e){try{let{name:r,email:t,nrp:s,password:a,role:i,poldaId:n,polresId:p,reason:l}=await e.json();if(!r||!t||!s||!a||!i)return o.NextResponse.json({error:"Semua field wajib diisi"},{status:400});if(await u._.user.findUnique({where:{email:t}}))return o.NextResponse.json({error:"Email sudah terdaftar"},{status:400});if(await u._.user.findUnique({where:{nrp:s}}))return o.NextResponse.json({error:"NRP sudah terdaftar"},{status:400});let c=await d.ZP.hash(a,12),m=await u._.user.create({data:{name:r,email:t,nrp:s,password:c,role:i,status:"PENDING",poldaId:n||null,polresId:p||null},include:{polda:{select:{name:!0}},polres:{select:{name:!0,polda:{select:{name:!0}}}}}});return console.log(`New user registration: ${r} (${t}) - Role: ${i} - Reason: ${l}`),o.NextResponse.json({success:!0,message:"Registrasi berhasil. Akun Anda sedang menunggu persetujuan admin.",user:{id:m.id,name:m.name,email:m.email,role:m.role,status:m.status}},{status:201})}catch(e){return console.error("Registration error:",e),o.NextResponse.json({error:"Terjadi kesalahan saat mendaftar",detail:e.message},{status:500})}}let h=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"C:\\Users\\sulth\\Documents\\work\\police-inventory\\src\\app\\api\\auth\\register\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:w,serverHooks:f}=h;function j(){return(0,n.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:w})}},35303:()=>{},47726:(e,r,t)=>{"use strict";t.d(r,{_:()=>a});var s=t(53524);let a=globalThis.prisma??new s.PrismaClient}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[3267,8814,2009],()=>t(92222));module.exports=s})();